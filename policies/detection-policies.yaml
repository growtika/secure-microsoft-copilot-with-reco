# Copilot Threat Detection Policies — Conceptual Reference
#
# These are conceptual policy definitions, not importable configs.
# Use them as a checklist when configuring detection rules in your
# SIEM, SOAR, or Reco platform. Adapt the thresholds and conditions
# to match your environment's baseline.
#
# Deploy in Preview mode during pilot, then switch to On for production.

policies:

  - name: "Copilot Bulk Data Access"
    description: "Detect when a user accesses an unusually high volume of files via Copilot"
    severity: high
    mode: preview
    trigger:
      event: copilot_file_access
      threshold: 50
      window: 1h
    conditions:
      - file_count > baseline_average * 3
      - unique_sites > 5
    actions:
      - alert → SOC team
      - restrict Copilot access for 24h

  - name: "Copilot Sensitive Content Surfacing"
    description: "Flag when Copilot responses reference files with high sensitivity labels"
    severity: high
    mode: preview
    trigger:
      event: copilot_response_generated
    conditions:
      - source_file_label in [Confidential, Highly Confidential]
      - user_clearance_level < file_sensitivity_level
    actions:
      - alert → SOC team
      - log full interaction details

  - name: "Copilot Anomalous Usage Pattern"
    description: "Detect deviations from normal Copilot interaction patterns"
    severity: medium
    mode: preview
    trigger:
      event: copilot_interaction
    conditions:
      - daily_query_count > baseline_p95
      - off_hours_usage == true
      - new_topic_categories > 3
    actions:
      - alert → security review queue
      - flag for manual review

  - name: "Copilot Cross-Boundary Access"
    description: "Monitor attempts to discover data across tenant boundaries"
    severity: critical
    mode: "on"
    trigger:
      event: copilot_query
    conditions:
      - target_scope == cross_tenant
      - guest_user == true
    actions:
      - block immediately
      - alert → SOC team (P1)
      - auto-create incident

  - name: "Copilot Data Exfiltration Attempt"
    description: "Detect patterns suggesting data exfiltration via Copilot"
    severity: critical
    mode: "on"
    trigger:
      event: copilot_interaction
    conditions:
      - copy_paste_volume > baseline * 5
      - external_share_attempt == true
      - session_duration > 2h
    actions:
      - block immediately
      - alert → SOC team (P1)

  - name: "Copilot Usage by Departing Employee"
    description: "Alert when users in departure workflow use Copilot"
    severity: high
    mode: "on"
    trigger:
      event: copilot_interaction
    conditions:
      - user_lifecycle_status == departing
    actions:
      - alert → HR security
      - restrict Copilot access

# Alert routing SLAs (adapt to your SOC):
#   Critical: 15 minutes
#   High: 4 hours
#   Medium: 24 hours
