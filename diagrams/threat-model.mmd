%% Copilot Threat Model
%% Maps threat actors, attack vectors, and security controls

graph TD
    subgraph "Threat Actors"
        TA1[Insider Threat<br/><i>Departing employee</i>]
        TA2[Compromised Account<br/><i>Credential theft</i>]
        TA3[Over-Privileged User<br/><i>Permission sprawl</i>]
        TA4[External Collaborator<br/><i>Guest account abuse</i>]
    end

    subgraph "Attack Vectors via Copilot"
        AV1[Bulk Data Harvesting<br/><i>Rapid queries across sites</i>]
        AV2[Sensitive Data Discovery<br/><i>Query for confidential content</i>]
        AV3[Cross-Boundary Probing<br/><i>Access data outside role scope</i>]
        AV4[Plugin Scope Exploitation<br/><i>Leverage over-permissioned plugins</i>]
        AV5[Exfiltration via Summaries<br/><i>Copy AI-generated summaries</i>]
    end

    subgraph "Assets at Risk"
        AR1[Financial Data<br/><i>Budgets, revenue, compensation</i>]
        AR2[Strategic Documents<br/><i>Board decks, M&A plans</i>]
        AR3[Employee PII<br/><i>HR records, performance reviews</i>]
        AR4[Customer Data<br/><i>Contracts, communications</i>]
        AR5[Intellectual Property<br/><i>Product roadmaps, source code</i>]
    end

    subgraph "Security Controls â€” Reco + M365"
        SC1[Conditional Access<br/>Block high-risk users]
        SC2[Sensitivity Labels<br/>Classify & restrict content]
        SC3[DLP Policies<br/>Prevent data leakage]
        SC4[Detection Policies<br/>Anomaly & bulk access alerts]
        SC5[Scope Monitoring<br/>Plugin permission review]
        SC6[Posture Checks<br/>Pre-deployment validation]
    end

    TA1 --> AV1 & AV2 & AV5
    TA2 --> AV1 & AV2 & AV3
    TA3 --> AV2 & AV3
    TA4 --> AV3 & AV4

    AV1 --> AR1 & AR2 & AR3
    AV2 --> AR1 & AR2 & AR3 & AR5
    AV3 --> AR4 & AR5
    AV4 --> AR1 & AR4
    AV5 --> AR1 & AR2 & AR5

    SC1 -.->|Mitigates| TA1 & TA2
    SC2 -.->|Protects| AR1 & AR2 & AR3
    SC3 -.->|Blocks| AV5
    SC4 -.->|Detects| AV1 & AV2 & AV3
    SC5 -.->|Monitors| AV4
    SC6 -.->|Prevents| AV1 & AV2 & AV3 & AV4 & AV5

    style TA1 fill:#d63031,color:#fff
    style TA2 fill:#d63031,color:#fff
    style TA3 fill:#e17055,color:#fff
    style TA4 fill:#e17055,color:#fff
    style AV1 fill:#fdcb6e,color:#000
    style AV2 fill:#fdcb6e,color:#000
    style AV3 fill:#fdcb6e,color:#000
    style AV4 fill:#fdcb6e,color:#000
    style AV5 fill:#fdcb6e,color:#000
    style AR1 fill:#ff7675,color:#fff
    style AR2 fill:#ff7675,color:#fff
    style AR3 fill:#ff7675,color:#fff
    style AR4 fill:#ff7675,color:#fff
    style AR5 fill:#ff7675,color:#fff
    style SC1 fill:#00b894,color:#fff
    style SC2 fill:#00b894,color:#fff
    style SC3 fill:#00b894,color:#fff
    style SC4 fill:#00b894,color:#fff
    style SC5 fill:#00b894,color:#fff
    style SC6 fill:#00b894,color:#fff
